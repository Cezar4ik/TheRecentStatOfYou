# The Recent Stat of You
[![Python 2.7.7](https://img.shields.io/badge/python-2.7.7-blue.svg)](https://www.python.org/download/releases/2.7.7/)
[![Build status](https://travis-ci.org/SerVB/TheRecentStatOfYou.svg?master)](https://travis-ci.org/SerVB/TheRecentStatOfYou)

Мод с открытым исходным кодом для отображения недавней статистики игроков в бою.

## Суть
Главное отличие этого мода от аналогичных &mdash; это возможность отображения обещающего быть более информативным **недавнего** рейтинга эффективности (примерно за последнюю тысячу боев, то есть примерно за последние 50 часов игрового времени). В остальном это всe тот же мод, который Вы видели у *XVM*, *PolarFox* и *Ekspoint*.

Мод позволяет отображать недавнюю статистику игроков в следующих местах:
- В окне загрузки боя.
- В ушах.
- В маркерах над техникой.
- В таблице игроков при нажатии Tab.

## Как это выглядит
На данный момент показ статистики достигается переименованием игроков: к имени добавляется префикс. Этот префикс выглядит так:
- Если есть данные о недавней статистике:  
`недавний_wn8[недавнее_количество_боев/общее_количество_боев]`.
- Если нет данных о недавней статистике:  
`wn8_за_все_время[общее_количество_боев]`.

Например: `1234[1003/15k]PlayerName`.

Если статистику по какой-то причине получить не получилось, выводятся вопросительные знаки. Причину можно узнать в логах игры.

## Как это работает
Данные берутся с сайтов [kttc.ru](https://kttc.ru/) (разрешение на использование от представителя сайта получено) и [noobmeter.com](http://noobmeter.com/) (связаться с представителем сайта не удалось, поэтому пока считаем, что запрета на использование сайта нет).

## Предложение
Разработчики всего мира, объединяйтесь! Из-за открытости кода мода каждый человек может понять, как он работает, а также внести свой вклад. Открытие Pull Request'ов, решающих как планируемые задачи, так и любые другие, приветствуется. Любые идеи по развитию также с радостью будут услышаны.

В ближайшее время я улучшать мод не планирую, ведь у меня есть другие проекты. Сам использую мод в текущем состоянии, и это меня устраивает.

## Далекие планы
во вкладке "Issues".

## Скриншоты и скачивание
во вкладке "Releases".

## Построение из исходников
Запустите файл `build.py` (рекомендуется версия Питона 2.7.7), исходники соберутся в папке `build/`.

## Известные проблемы
- При начале загрузки боя происходит подвисание от трех до десяти секунд, связанное со скачиванием данных с сайта. Запросы происходят многопоточно, асинхронно и одновременно, поэтому тут вряд ли можно что-то улучшить. Даже если найдется способ получать статистику всех игроков в бою за один запрос, он будет проходить за то же время...
- Клиент иногда пишет в лог, что не может найти ник игрока и поэтому использует более медленный вариант поиска. Наверное, это связано с тем, что мод фактически переименовывает игроков. Пока видимых симптомов в клиенте игры не замечено. Но с обновлением клиента это может стать причиной вылетов, если не полной неработоспособности...

## FAQ
**Q**. Новая версия Танков, а мод не адаптирован. Автор признаков жизни не подает. Моду конец?  
**A**. Посмотрите файлы, изменяемые модом, в файле `build.json`. Найдите те же файлы в репозитории декомпилированных файлов танкового клиента [WorldOfTanks-Decompiled](https://github.com/StranikS-Scan/WorldOfTanks-Decompiled/). Если они не менялись с новым патчем, то мод скорее всего будет работать в новой версии, необходимо только переложить его в папку с номером новой версии (по крайней мере, при обновлении с 1.0 на 1.1 код мода модифицировать не пришлось).

**Q**. На каком кластере работает мод?  
**A**. На данный момент скомпилированная мной версия мода работает только на `ru` кластере. Если Вы хотите использовать мод в другом регионе, измените константу `REGION_SETTING = "ru"` в файле `mod_recent_stat_config.py` самостоятельно и скомпилируйте новый файл для себя.

**Q**. Какой сайт статистики сейчас используется?  
**A**. На данный момент скомпилированная мной версия мода использует сайт КТТС. Для смены на данный момент предполагается изменение файла `mod_recent_stat_config.py` и его компиляция самостоятельно.

**Q**. Какова лицензия?  
**A**. Apache 2.0.

## Благодарности
- **VasyaPRO_2014** &mdash; идея создания мода статистики в бою с открытым исходным кодом; система сборки мода ([тема на Korean Random](https://koreanrandom.com/forum/topic/29691-09152-%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0-%D0%B8%D0%B3%D1%80%D0%BE%D0%BA%D0%BE%D0%B2-%D0%B2-%D0%B1%D0%BE%D1%8E-%D0%B1%D0%B5%D0%B7-xvm/), [репозиторий на GitHub](https://github.com/VasyaPRO/StatsInBattle)).
- Проект [WorldOfTanks-Decompiled](https://github.com/StranikS-Scan/WorldOfTanks-Decompiled/) &mdash; декомпилированные файлы танкового клиента использовались для создания мода.
- Сайты [kttc.ru](https://kttc.ru/) и [noobmeter.com](http://noobmeter.com/) &mdash; провайдеры недавней статистики игроков.
- [Люди](https://github.com/SerVB/TheRecentStatOfYou/graphs/contributors), которые контрибьютили непосредственно в проект.
